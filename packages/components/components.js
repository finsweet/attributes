(()=>{var E=(c,e,t)=>new Promise((n,r)=>{var o=s=>{try{i(t.next(s))}catch(a){r(a)}},l=s=>{try{i(t.throw(s))}catch(a){r(a)}},i=s=>s.done?n(s.value):Promise.resolve(s.value).then(o,l);i((t=t.apply(c,e)).next())});var f=class{static activateAlerts(){this.alertsActivated=!0}static alert(e,t){if(this.alertsActivated&&window.alert(e),t==="error")throw new Error(e)}};f.alertsActivated=!1;var m=(c,e)=>(Array.isArray(e)||(e=[e]),e.map(n=>c.dispatchEvent(new Event(n,{bubbles:!0}))).every(n=>n));var v=(c,e=!0)=>c.cloneNode(e);var I=(c,e,t=document)=>{let n=t.querySelector(c);if(n instanceof e)return n};var L=c=>new Promise(e=>setTimeout(e,c));var u=class{constructor({element:e,duration:t}){this.active=!1;this.running=!1;this.isActive=()=>this.active;this.isRunning=()=>this.running;this.untilFinished=()=>this.runningPromise;var n,r;this.element=typeof e=="string"?I(e,HTMLElement)||f.alert(`No interaction with the ${e} selector was found.`,"error"):e,this.duration={first:typeof t=="number"?t:(n=t==null?void 0:t.first)!=null?n:0,second:typeof t=="number"?t:(r=t==null?void 0:t.second)!=null?r:0}}trigger(e){return E(this,null,function*(){return e==="first"&&this.active||e==="second"&&!this.active?!1:(e||(e=this.active?"second":"first"),m(this.element,"click"),this.running=!0,this.runningPromise=L(this.duration[e]),yield this.runningPromise,this.running=!1,this.active=e==="first",!0)})}};var g="fs-uswds",d=`${g}-element`,h={toggle:`[${d}="combo-box-toggle"]`,clearInput:`[${d}="combo-box-clear-input"]`,clearInputInteraction:`[${d}="combo-box-clear-input-ix2"]`,listInteraction:`[${d}="combo-box-list-ix2"]`},b={selectedItemClass:`${g}-selected-class`},x=class{constructor({parentElement:e,inputElement:t,selectElement:n,listElement:r,listElementInteraction:o,listItemTemplate:l,clearInputElementInteraction:i}){this.listItems=[];this.listIsOpen=!1;this.parentElement=e,this.inputElement=t,this.selectElement=n,this.listElement=r,this.clearInputElementInteraction=new u({element:i}),this.listElementInteraction=new u({element:o}),this.populateListItems(l),this.listenEvents()}populateListItems(e){let{selectElement:{options:t},listElement:n,listItems:r}=this;e.remove(),n.innerHTML="",this.selectedItemClass=e.getAttribute(b.selectedItemClass),e.removeAttribute(b.selectedItemClass),[...t].forEach(({text:o,value:l},i)=>{if(!l)return;let s=v(e);s.setAttribute("tabindex",i===0?"0":"-1"),s.setAttribute("role","option"),this.selectedItemClass&&s.classList.remove(this.selectedItemClass),s.textContent=o,n.appendChild(s),r.push({text:o,value:l,element:s})}),this.filterListItems()}listenEvents(){let{parentElement:e}=this;e.addEventListener("click",t=>this.handleClickEvents(t)),e.addEventListener("keydown",t=>this.handleKeydownEvents(t)),e.addEventListener("keyup",t=>this.handleUpEvents(t)),e.addEventListener("focusin",t=>this.handleFocusEvents(t)),e.addEventListener("input",t=>this.handleInputEvents(t)),document.addEventListener("focusin",t=>this.handleBlur(t)),document.addEventListener("click",t=>this.handleBlur(t))}handleClickEvents({target:e}){if(!(e instanceof Element))return;if(e.closest(h.toggle)){this.toggleList();return}if(e.closest("input")){this.toggleList({action:"open"});return}let t=e.closest("li");if(t){this.selectListItem(t);return}e.closest(h.clearInput)&&this.clearInput()}handleKeydownEvents(e){let{target:t,key:n}=e,{inputElement:r}=this;if(!(t instanceof Element))return;if(n==="Escape"){this.toggleList({action:"close",focus:"inputElement"});return}if(n!=="ArrowUp"&&n!=="ArrowDown")return;if(e.preventDefault(),t===r&&n==="ArrowDown"){this.toggleList({action:"open",focus:"selectedListItemElement"});return}let o=t.closest("li");o&&this.navigateListItems({key:n,listItemElement:o})}handleUpEvents(e){let{target:t,key:n}=e,{inputElement:r}=this;t instanceof Element&&(n==="Escape"||n==="ArrowDown"||n==="ArrowUp"||n==="ArrowRight"||n==="ArrowLeft"||t===r&&this.filterListItems({openList:!0}))}handleFocusEvents({target:e}){var n;if(!(e instanceof Element))return;let t=e.closest("li");if(t){(n=this.focusedListItemElement)==null||n.setAttribute("tabindex","-1"),t.setAttribute("tabindex","0"),this.focusedListItemElement=t;return}}handleInputEvents({target:e}){let{inputElement:t,clearInputElementInteraction:n}=this;e===t&&(t.value?n.trigger("first"):n.trigger("second"))}navigateListItems({key:e,listItemElement:t}){let{listItems:n,listElement:r}=this,o=n.findIndex(({element:i})=>i===t),l;if(e==="ArrowUp")for(let i=o-1;i>=0;i--){let{element:s}=n[i];if(r.contains(s)){l=s;break}}if(e==="ArrowDown")for(let i=o+1;i<n.length;i++){let{element:s}=n[i];if(r.contains(s)){l=s;break}}if(!l&&e==="ArrowUp"){this.toggleList({action:"close",focus:"inputElement"});return}l==null||l.focus()}filterListItems({openList:e}={}){let{listElement:t,listItems:n,inputElement:{value:r}}=this,o=r.toLowerCase().trim(),l=[],i=[];n.forEach(({element:s,text:a})=>{!o||a.toLowerCase().trim().includes(o)?l.push(s):i.push(s)}),i.forEach(s=>s.remove()),l.forEach((s,a)=>{s.setAttribute("aria-posinset",(a+1).toString()),s.setAttribute("aria-setsize",l.length.toString()),t.appendChild(s)}),e&&this.toggleList({action:"open"})}handleBlur({target:e}){e instanceof Node&&(this.parentElement.contains(e)||this.toggleList({action:"close"}))}selectListItem(e){let{selectElement:t,inputElement:n,selectedItemClass:r,selectedListItemElement:o,listItems:l}=this,i=e?l.find(({element:p})=>p===e):{text:"",value:""};if(!i)return;let{text:s,value:a}=i;t.value=a,n.value=s,m(n,"input"),r&&(o==null||o.classList.remove(r),e==null||e.classList.add(r)),this.selectedListItemElement=e,this.toggleList({action:"close",focus:"inputElement"})}clearInput(){let{inputElement:e}=this;this.selectListItem(),e.value="",e.focus()}toggleList(){return E(this,arguments,function*({action:e,focus:t}={}){var p;let{listIsOpen:n,listElementInteraction:r,inputElement:o,listItems:l,listElement:i}=this,{selectedListItemElement:s}=this;e||(e=n?"close":"open");let a=e==="open";n!==a&&(r.trigger(a?"first":"second"),o.setAttribute("aria-expanded",a?"true":"false")),t==="inputElement"&&o.focus(),t==="selectedListItemElement"&&(s||(s=(p=l.find(({element:y})=>i.contains(y)))==null?void 0:p.element),window.requestAnimationFrame(()=>s==null?void 0:s.focus())),this.listIsOpen=a})}},T=()=>{document.querySelectorAll('input[role="combobox"]').forEach(e=>{let{parentElement:t}=e;if(!t)return;let n=t.querySelector("select");if(!n)return;let r=t.querySelector("ul, ol"),o=t.querySelector(h.listInteraction);if(!r||!o)return;let l=r.querySelector("li");if(!l)return;let i=t.querySelector(h.clearInputInteraction);!i||new x({parentElement:t,inputElement:e,selectElement:n,listElement:r,listItemTemplate:l,clearInputElementInteraction:i,listElementInteraction:o})})};document.addEventListener("DOMContentLoaded",()=>{T()});})();
