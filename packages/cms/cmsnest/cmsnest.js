(()=>{var u=(e,t,n)=>new Promise((i,o)=>{var r=s=>{try{l(n.next(s))}catch(m){o(m)}},a=s=>{try{l(n.throw(s))}catch(m){o(m)}},l=s=>s.done?i(s.value):Promise.resolve(s.value).then(r,a);l((n=n.apply(e,t)).next())});var p=class{static activateAlerts(){this.alertsActivated=!0}static alert(t,n){if(this.alertsActivated&&window.alert(t),n==="error")throw new Error(t)}};p.alertsActivated=!1;var w={wrapper:"w-dyn-list",list:"w-dyn-items",item:"w-dyn-item",paginationWrapper:"w-pagination-wrapper",paginationNext:"w-pagination-next",paginationPrevious:"w-pagination-previous",pageCount:"w-page-count",emptyState:"w-dyn-empty"};var y=(e,t=!0)=>e.cloneNode(t);var{wrapper:G,list:X,paginationWrapper:J,paginationNext:Q,paginationPrevious:Y,emptyState:Z,pageCount:ee}=w;function d(e,t,n=document){let i=typeof e=="string"?n.querySelector(e):e;if(!i)return;let o=i.closest(`.${G}`);if(!o)return;let r=o.querySelector(`.${X}`);return t==="wrapper"?o:t==="list"?r:t==="items"?[...(r==null?void 0:r.children)||[]]:t==="empty"?o.querySelector(`.${Z}`):t==="pageCount"?o.querySelector(`.${ee}`):t==="pagination"?o.querySelector(`.${J}`):o.querySelector(`.${t==="next"?Q:Y}`)}var L=(e,t=document)=>{e=e.filter(r=>r);let n=e.join(", ")||`.${w.wrapper}`;return[...t.querySelectorAll(n)].reduce((r,a)=>{if(!a)return r;let l=d(a,"wrapper");return!l||r.includes(l)||r.push(l),r},[])};var v="fs-attributes",_={preventLoad:{key:`${v}-preventload`},matchMedia:{key:`${v}-matchmedia`},debugMode:{key:`${v}-debug`}};var{preventLoad:{key:te},debugMode:{key:oe},matchMedia:{key:ne}}=_,V=()=>{window.fsAttributes||(window.fsAttributes={cms:{}})},R=e=>{if(!e)return{};let t=typeof(e==null?void 0:e.getAttribute(te))=="string";typeof(e==null?void 0:e.getAttribute(oe))=="string"&&p.activateAlerts();let n=e==null?void 0:e.getAttribute(ne);return{preventsLoad:t,matchMedia:n}};var B=e=>(n,i,o)=>{let r=e[n],{key:a,values:l}=r,s;if(!i)return`[${a}]`;let m=l==null?void 0:l[i];if(typeof m=="string"?s=m:s=m(o&&"instanceIndex"in o?o.instanceIndex:void 0),!(o==null?void 0:o.operator))return`[${a}="${s}"]`;switch(o.operator){case"prefixed":return`[${a}^="${s}"]`;case"suffixed":return`[${a}$="${s}"]`;case"contains":return`[${a}*="${s}"]`}};var re="https://cdn.jsdelivr.net/npm/@finsweet/attributes-cmscore@1.1.2/cmscore.js";var E=()=>u(void 0,null,function*(){let{fsAttributes:e}=window;if(e.cms||(e.cms={}),e.cms.coreImport)return e.cms.coreImport;try{let t=import(re);return e.cms.coreImport=t,t}catch(t){p.alert(`${t}`,"error");return}});var h="fs-cmsnest",g={element:{key:`${h}-element`,values:{list:"list"}},collection:{key:`${h}-collection`},empty:{key:`${h}-empty`}},f=B(g);var{collection:{key:O},empty:{key:ie}}=g,F=({createCMSListInstances:e})=>{let t=new Map,n=e([f("collection")]);for(let i of n){let o=i.getAttribute(O);if(!o)continue;let r=document.querySelector(`[${ie}^="${o}"]`);r&&r.remove(),i.wrapper.remove(),t.set(o,{listInstance:i,emptyElement:r})}return t},q=e=>{let t=new Map,n=e.querySelectorAll(f("collection"));for(let i of n){let o=i.getAttribute(O);!o||t.set(o,i)}return t};var se=new DOMParser,N=(o,r,a)=>u(void 0,[o,r,a],function*({element:e,href:t},n,{CMSList:i}){if(!t)return;let l=q(e);if(!l.size)return;let m=yield(yield fetch(t)).text(),U=se.parseFromString(m,"text/html"),j=L([f("collection")],U);for(let H of j){let $=new i(H),b=$.getAttribute(g.collection.key);if(!b)continue;let k=n.get(b),C=l.get(b);if(!k||!C)continue;let P=C.parentElement;if(!P)continue;let{listInstance:W,emptyElement:A}=k,T=$.items.reduce((c,{href:I})=>{if(!I)return c;let x=W.items.find(D=>D.href&&I===D.href);return x&&c.push(x.element),c},[]);if(!T.length&&!A)continue;let S=y(W.wrapper),z=d(S,"items");if(T.length)for(let c of z)!!T.find(x=>x.isEqualNode(c))||c.remove();else if(A){let c=d(S,"list");c==null||c.remove(),S.appendChild(y(A))}P.insertBefore(S,C),C.remove()}});var M=()=>u(void 0,null,function*(){let e=yield E();if(!e)return[];let t=e.createCMSListInstances([f("element","list",{operator:"prefixed"})]);for(let n of t)K(n,e);return yield Promise.all(t.map(n=>K(n,e))),t}),K=(e,t)=>u(void 0,null,function*(){let n=F(t);if(!n.size){p.alert(`No collections to nest found for the list n\xBA ${e.index}`,"info");return}e.on("shouldnest",o=>u(void 0,null,function*(){yield Promise.all(o.map(r=>N(r,n,t)))}));let i=[...e.items];yield Promise.all(i.map(o=>N(o,n,t))),yield e.emitSerial("nestinitialitems",i)});V();var{currentScript:le}=document,{preventsLoad:ce}=R(le);E();ce?window.fsAttributes.cmsnest={init:M}:(window.Webflow||(window.Webflow=[]),window.Webflow.push(M));})();
