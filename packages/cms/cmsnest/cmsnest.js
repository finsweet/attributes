(()=>{var u=(e,t,o)=>new Promise((n,r)=>{var i=s=>{try{l(o.next(s))}catch(m){r(m)}},a=s=>{try{l(o.throw(s))}catch(m){r(m)}},l=s=>s.done?n(s.value):Promise.resolve(s.value).then(i,a);l((o=o.apply(e,t)).next())});var p=class{static activateAlerts(){this.alertsActivated=!0}static alert(t,o){if(this.alertsActivated&&window.alert(t),o==="error")throw new Error(t)}};p.alertsActivated=!1;var E={wrapper:"w-dyn-list",list:"w-dyn-items",item:"w-dyn-item",paginationWrapper:"w-pagination-wrapper",paginationNext:"w-pagination-next",paginationPrevious:"w-pagination-previous",pageCount:"w-page-count",emptyState:"w-dyn-empty"};var b=(e,t=!0)=>e.cloneNode(t);var{wrapper:X,list:J,paginationWrapper:Q,paginationNext:Y,paginationPrevious:Z,emptyState:ee,pageCount:te}=E;function g(e,t,o=document){let n=typeof e=="string"?o.querySelector(e):e;if(!n)return;let r=n.closest(`.${X}`);if(!r)return;let i=r.querySelector(`.${J}`);return t==="wrapper"?r:t==="list"?i:t==="items"?[...(i==null?void 0:i.children)||[]]:t==="empty"?r.querySelector(`.${ee}`):t==="pageCount"?r.querySelector(`.${te}`):t==="pagination"?r.querySelector(`.${Q}`):r.querySelector(`.${t==="next"?Y:Z}`)}var v=(e,t=document)=>{e=e.filter(i=>i);let o=e.join(", ")||`.${E.wrapper}`;return[...t.querySelectorAll(o)].reduce((i,a)=>{if(!a)return i;let l=g(a,"wrapper");return!l||i.includes(l)||i.push(l),i},[])};var _="fs-attributes",V={preventLoad:{key:`${_}-preventload`},debugMode:{key:`${_}-debug`}};var B=()=>{window.fsAttributes||(window.fsAttributes={cms:{}})},R=e=>{let{preventLoad:t,debugMode:o}=V,n=typeof(e==null?void 0:e.getAttribute(t.key))=="string";return typeof(e==null?void 0:e.getAttribute(o.key))=="string"&&p.activateAlerts(),{preventsLoad:n}};var O=e=>(o,n,r)=>{let i=e[o],{key:a,values:l}=i,s;if(!n)return`[${a}]`;let m=l==null?void 0:l[n];if(typeof m=="string"?s=m:s=m(r&&"instanceIndex"in r?r.instanceIndex:void 0),!(r==null?void 0:r.operator))return`[${a}="${s}"]`;switch(r.operator){case"prefixed":return`[${a}^="${s}"]`;case"suffixed":return`[${a}$="${s}"]`;case"contains":return`[${a}*="${s}"]`}};var oe="https://cdn.jsdelivr.net/npm/@finsweet/attributes-cmscore@1/cmscore.js";var w=()=>u(void 0,null,function*(){let{fsAttributes:e}=window;e.cms||(e.cms={});let{cms:t}=e;if(t.coreImport)return t.coreImport;try{let o=import(oe);return t.coreImport=o,o.then(n=>{n&&(t.coreVersion||(t.coreVersion=n.version))}),o}catch(o){p.alert(`${o}`,"error");return}});var N="fs-cmsnest",d={element:{key:`${N}-element`,values:{list:"list"}},collection:{key:`${N}-collection`},empty:{key:`${N}-empty`}},f=O(d);function C(e){return e==null?void 0:e.trim().toLowerCase()}var{collection:{key:F},empty:{key:re}}=d,q=({createCMSListInstances:e})=>{let t=new Map,o=e([f("collection")]);for(let n of o){let r=C(n.getAttribute(F));if(!r)continue;let i=document.querySelector(`[${re}^="${r}"]`);i&&i.remove(),n.wrapper.remove(),t.set(r,{listInstance:n,emptyElement:i})}return t},K=e=>{let t=new Map,o=e.querySelectorAll(f("collection"));for(let n of o){let r=C(n.getAttribute(F));!r||t.set(r,n)}return t};var ne=new DOMParser,$=(r,i,a)=>u(void 0,[r,i,a],function*({element:e,href:t},o,{CMSList:n}){if(!t)return;let l=K(e);if(!l.size)return;let m=yield(yield fetch(t)).text(),j=ne.parseFromString(m,"text/html"),z=v([f("collection")],j);for(let H of z){let h=new n(H),T=C(h.getAttribute(d.collection.key));if(!T)continue;let M=o.get(T),S=l.get(T);if(!M||!S)continue;let k=S.parentElement;if(!k)continue;let{listInstance:W,emptyElement:A}=M,I=h.items.reduce((c,{href:L})=>{if(!L)return c;let y=W.items.find(D=>D.href&&L===D.href);return y&&c.push(y.element),c},[]);if(!I.length&&!A)continue;let x=b(W.wrapper),G=g(x,"items");if(I.length)for(let c of G)!!I.find(y=>y.isEqualNode(c))||c.remove();else if(A){let c=g(x,"list");c==null||c.remove(),x.appendChild(b(A))}k.insertBefore(x,S),S.remove()}});var P=()=>u(void 0,null,function*(){let e=yield w();if(!e)return[];let t=e.createCMSListInstances([f("element","list",{operator:"prefixed"})]);for(let o of t)U(o,e);return yield Promise.all(t.map(o=>U(o,e))),t}),U=(e,t)=>u(void 0,null,function*(){let o=q(t);if(!o.size){p.alert(`No collections to nest found for the list n\xBA ${e.index}`,"info");return}e.on("shouldnest",r=>u(void 0,null,function*(){yield Promise.all(r.map(i=>$(i,o,t)))}));let n=[...e.items];yield Promise.all(n.map(r=>$(r,o,t))),yield e.emitSerial("nestinitialitems",n)});B();var{currentScript:ie}=document,{preventsLoad:se}=R(ie);w();se?window.fsAttributes.cmsnest={init:P}:(window.Webflow||(window.Webflow=[]),window.Webflow.push(P));})();
