var ae=Object.create;var I=Object.defineProperty,ce=Object.defineProperties,ue=Object.getOwnPropertyDescriptor,pe=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertyNames,P=Object.getOwnPropertySymbols,fe=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var U=(n,e,t)=>e in n?I(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,M=(n,e)=>{for(var t in e||(e={}))W.call(e,t)&&U(n,t,e[t]);if(P)for(var t of P(e))G.call(e,t)&&U(n,t,e[t]);return n},J=(n,e)=>ce(n,pe(e)),de=n=>I(n,"__esModule",{value:!0});var Q=(n,e)=>{var t={};for(var r in n)W.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&P)for(var r of P(n))e.indexOf(r)<0&&G.call(n,r)&&(t[r]=n[r]);return t};var be=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var ge=(n,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of me(e))!W.call(n,r)&&r!=="default"&&I(n,r,{get:()=>e[r],enumerable:!(t=ue(e,r))||t.enumerable});return n},ye=n=>ge(de(I(n!=null?ae(fe(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var u=(n,e,t)=>new Promise((r,o)=>{var i=a=>{try{l(t.next(a))}catch(d){o(d)}},s=a=>{try{l(t.throw(a))}catch(d){o(d)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(i,s);l((t=t.apply(n,e)).next())});var te=be((De,ee)=>{"use strict";var b=new WeakMap,T=new WeakMap,C=new WeakMap,V=Symbol("anyProducer"),X=Promise.resolve(),D=Symbol("listenerAdded"),$=Symbol("listenerRemoved"),k=!1;function h(n){if(typeof n!="string"&&typeof n!="symbol")throw new TypeError("eventName must be a string or a symbol")}function v(n){if(typeof n!="function")throw new TypeError("listener must be a function")}function S(n,e){let t=T.get(n);return t.has(e)||t.set(e,new Set),t.get(e)}function A(n,e){let t=typeof e=="string"||typeof e=="symbol"?e:V,r=C.get(n);return r.has(t)||r.set(t,new Set),r.get(t)}function he(n,e,t){let r=C.get(n);if(r.has(e))for(let o of r.get(e))o.enqueue(t);if(r.has(V)){let o=Promise.all([e,t]);for(let i of r.get(V))i.enqueue(o)}}function Y(n,e){e=Array.isArray(e)?e:[e];let t=!1,r=()=>{},o=[],i={enqueue(s){o.push(s),r()},finish(){t=!0,r()}};for(let s of e)A(n,s).add(i);return{next(){return u(this,null,function*(){return o?o.length===0?t?(o=void 0,this.next()):(yield new Promise(s=>{r=s}),this.next()):{done:!1,value:yield o.shift()}:{done:!0}})},return(l){return u(this,arguments,function*(s){o=void 0;for(let a of e)A(n,a).delete(i);return r(),arguments.length>0?{done:!0,value:yield s}:{done:!0}})},[Symbol.asyncIterator](){return this}}}function Z(n){if(n===void 0)return N;if(!Array.isArray(n))throw new TypeError("`methodNames` must be an array of strings");for(let e of n)if(!N.includes(e))throw typeof e!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${e} is not Emittery method`);return n}var F=n=>n===D||n===$,g=class{static mixin(e,t){return t=Z(t),r=>{if(typeof r!="function")throw new TypeError("`target` must be function");for(let s of t)if(r.prototype[s]!==void 0)throw new Error(`The property \`${s}\` already exists on \`target\``);function o(){return Object.defineProperty(this,e,{enumerable:!1,value:new g}),this[e]}Object.defineProperty(r.prototype,e,{enumerable:!1,get:o});let i=s=>function(...l){return this[e][s](...l)};for(let s of t)Object.defineProperty(r.prototype,s,{enumerable:!1,value:i(s)});return r}}static get isDebugEnabled(){if(typeof process!="object")return k;let{env:e}=process||{env:{}};return e.DEBUG==="emittery"||e.DEBUG==="*"||k}static set isDebugEnabled(e){k=e}constructor(e={}){b.set(this,new Set),T.set(this,new Map),C.set(this,new Map),this.debug=e.debug||{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(t,r,o,i)=>{i=JSON.stringify(i),typeof o=="symbol"&&(o=o.toString());let s=new Date,l=`${s.getHours()}:${s.getMinutes()}:${s.getSeconds()}.${s.getMilliseconds()}`;console.log(`[${l}][emittery:${t}][${r}] Event Name: ${o}
	data: ${i}`)})}logIfDebugEnabled(e,t,r){(g.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,r)}on(e,t){v(t),e=Array.isArray(e)?e:[e];for(let r of e)h(r),S(this,r).add(t),this.logIfDebugEnabled("subscribe",r,void 0),F(r)||this.emit(D,{eventName:r,listener:t});return this.off.bind(this,e,t)}off(e,t){v(t),e=Array.isArray(e)?e:[e];for(let r of e)h(r),S(this,r).delete(t),this.logIfDebugEnabled("unsubscribe",r,void 0),F(r)||this.emit($,{eventName:r,listener:t})}once(e){return new Promise(t=>{let r=this.on(e,o=>{r(),t(o)})})}events(e){e=Array.isArray(e)?e:[e];for(let t of e)h(t);return Y(this,e)}emit(e,t){return u(this,null,function*(){h(e),this.logIfDebugEnabled("emit",e,t),he(this,e,t);let r=S(this,e),o=b.get(this),i=[...r],s=F(e)?[]:[...o];yield X,yield Promise.all([...i.map(l=>u(this,null,function*(){if(r.has(l))return l(t)})),...s.map(l=>u(this,null,function*(){if(o.has(l))return l(e,t)}))])})}emitSerial(e,t){return u(this,null,function*(){h(e),this.logIfDebugEnabled("emitSerial",e,t);let r=S(this,e),o=b.get(this),i=[...r],s=[...o];yield X;for(let l of i)r.has(l)&&(yield l(t));for(let l of s)o.has(l)&&(yield l(e,t))})}onAny(e){return v(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),b.get(this).add(e),this.emit(D,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return Y(this)}offAny(e){v(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),this.emit($,{listener:e}),b.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(let t of e)if(this.logIfDebugEnabled("clear",t,void 0),typeof t=="string"||typeof t=="symbol"){S(this,t).clear();let r=A(this,t);for(let o of r)o.finish();r.clear()}else{b.get(this).clear();for(let r of T.get(this).values())r.clear();for(let r of C.get(this).values()){for(let o of r)o.finish();r.clear()}}}listenerCount(e){e=Array.isArray(e)?e:[e];let t=0;for(let r of e){if(typeof r=="string"){t+=b.get(this).size+S(this,r).size+A(this,r).size+A(this).size;continue}typeof r!="undefined"&&h(r),t+=b.get(this).size;for(let o of T.get(this).values())t+=o.size;for(let o of C.get(this).values())t+=o.size}return t}bindMethods(e,t){if(typeof e!="object"||e===null)throw new TypeError("`target` must be an object");t=Z(t);for(let r of t){if(e[r]!==void 0)throw new Error(`The property \`${r}\` already exists on \`target\``);Object.defineProperty(e,r,{enumerable:!1,value:this[r].bind(this)})}}},N=Object.getOwnPropertyNames(g.prototype).filter(n=>n!=="constructor");Object.defineProperty(g,"listenerAdded",{value:D,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(g,"listenerRemoved",{value:$,writable:!1,enumerable:!0,configurable:!1});ee.exports=g});var ne=ye(te());var L=class{constructor(e,t,r){this.element=e;this.list=t;this.currentIndex=r;this.props={};this.mustShow=!0;var o;this.href=(o=e.querySelector("a"))==null?void 0:o.href}};var E=class{static activateAlerts(){this.alertsActivated=!0}static alert(e,t){if(this.alertsActivated&&window.alert(e),t==="error")throw new Error(e)}};E.alertsActivated=!1;var w={wrapper:"w-dyn-list",list:"w-dyn-items",item:"w-dyn-item",paginationNext:"w-pagination-next",paginationPrevious:"w-pagination-previous",emptyState:"w-dyn-empty"};var _=n=>{let e=n.split("-"),t=parseInt(e[e.length-1]);if(!isNaN(t))return t};var B=n=>new Promise(e=>setTimeout(e,n));var j=n=>n!=null;var{wrapper:Se,list:Ee,paginationNext:we,paginationPrevious:xe,emptyState:Ce}=w;function f(n,e,t=document){let r=typeof n=="string"?t.querySelector(n):n;if(!r)return;let o=r.closest(`.${Se}`);if(!o)return;let i=o.querySelector(`.${Ee}`);return e==="wrapper"?o:e==="list"?i:e==="items"?[...(i==null?void 0:i.children)||[]]:e==="empty"?o.querySelector(`.${Ce}`):o.querySelector(`.${e==="next"?we:xe}`)}var q=(n,e=document)=>{n=n.filter(i=>i);let t=n.join(", ")||`.${w.wrapper}`;return[...e.querySelectorAll(t)].reduce((i,s)=>{if(!s)return i;let l=f(s,"wrapper");return!l||i.includes(l)||i.push(l),i},[])};var R=(n,e)=>{let t=n.getAttribute(e);return t?_(t):void 0};var re=(n,e=!1)=>u(void 0,null,function*(){let{items:t,itemsPerPage:r,currentPage:o,emptyState:i}=n,s=[],l=[],a=0;for(let c of t){let{mustShow:p,currentIndex:m}=c;if(p){if(a+=1,!o){l.push(c);continue}a>(o-1)*r&&a<=o*r?l.push(c):typeof m=="number"&&s.push(c)}else typeof m=="number"&&s.push(c)}let d=[];if(l.forEach((c,p)=>{c.currentIndex!==p&&d.push([c,p,l[p-1]])}),e||(yield n.displayElement(i?"emptyElement":"list",!1)),yield Promise.all([...Ae(s,n,e),...Le(d,n,e)]),n.emit("renderitems",l),!e){let c=!a;n.emptyState=c,yield n.displayElement(c?"emptyElement":"list")}}),Ae=(n,{itemsAnimation:e},t)=>n.map(r=>u(void 0,null,function*(){let{element:o}=r;if(t&&e){let{animateOut:i,options:s}=e;yield i(o,M({remove:!0},s))}else o.remove();r.currentIndex=void 0})),Le=(n,{list:e,itemsAnimation:t},r)=>n.map((a,d)=>u(void 0,[a,d],function*([o,i,s],l){o.animating=new Promise(c=>u(void 0,null,function*(){o.rendering=new Promise(p=>u(void 0,null,function*(){yield s==null?void 0:s.rendering;let{element:m,currentIndex:x}=o,y=(s==null?void 0:s.element)||null;if(typeof x!="number"&&r&&t){let{prepareIn:oe,animateIn:ie,options:se}=t,H=se||{},{stagger:z}=H,le=Q(H,["stagger"]),K=M({target:e,insertAfter:y},le);oe(m,K),p(),z&&(yield B(z*l)),yield ie(m,J(M({},K),{prepared:!0}))}else y?e.insertBefore(m,y.nextSibling):e.prepend(m),p();c()}))})),yield o.rendering,o.currentIndex=i}));var O=class extends ne.default{constructor(e,{index:t}={}){super();this.wrapper=e;this.index=t,this.list=f(this.wrapper,"list"),this.paginationNext=f(this.wrapper,"next"),this.paginationPrevious=f(this.wrapper,"previous");let r=f(this.wrapper,"items");this.itemsPerPage=r.length,this.items=r.map((o,i)=>new L(o,this.list,i))}addItems(e){return u(this,null,function*(){let{items:t,list:r}=this,o=e.map(i=>new L(i,r));t.push(...o),yield this.emit("shouldnest",o),yield this.emit("shouldcollectprops",o),yield this.emit("shouldsort",o),yield this.emit("shouldfilter"),yield this.renderItems(!0),yield this.emit("additems",o)})}renderItems(e){return u(this,null,function*(){yield this.renderingQueue,this.renderingQueue=re(this,e)})}displayElement(e,t=!0){return u(this,null,function*(){let{listAnimation:r}=this,o=this[e];if(!!o)if(r){let{animateIn:i,animateOut:s,options:l}=r;yield(t?i:s)(o,l)}else o.style.display=t?"":"none"})}addEmptyElement(e){let{wrapper:t,list:r,emptyElement:o}=this;o||(e.style.display="none",t.insertBefore(e,r.nextSibling),this.emptyElement=e)}getAttribute(e){let{wrapper:t,list:r}=this;return t.getAttribute(e)||r.getAttribute(e)}getInstanceIndex(e){let{wrapper:t,list:r}=this;return R(t,e)||R(r,e)}};var Ie=n=>q(n).map(Pe).filter(j),Pe=n=>{var s,l;let e=f(n,"wrapper");if(!e){E.alert("The element is not a Collection List.","error");return}let{fsAttributes:t}=window;(s=t.cms).lists||(s.lists=[]),(l=t.cms).listElements||(l.listElements=[...document.querySelectorAll(`.${w.wrapper}`)]);let{lists:r,listElements:o}=t.cms,i=o.indexOf(e);if(i!==-1)return r[i]||(r[i]=new O(e,{index:i})),r[i]};var Me=(n,{fieldKey:e,typeKey:t,rangeKey:r})=>{for(let{element:o,props:i}of n){let s=[...o.querySelectorAll(`[${e}]`)];for(let l of s){let a=l.getAttribute(e),d=t?l.getAttribute(t):void 0,c=r?l.getAttribute(r):void 0,{textContent:p}=l;if(!a||!p)continue;i[a]||(i[a]={type:d,range:c,values:new Set});let m=i[a],{values:x}=m;if(c==="from"||c==="to"){let y=[...x];y[c==="from"?0:1]=p,m.values=new Set(y)}x.add(p)}}};export{L as CMSItem,O as CMSList,Me as collectItemsProps,Ie as createCMSListInstances};
